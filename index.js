(()=>{"use strict";const e=class{constructor(e,{inputSelector:t,submitButtonSelector:s,inactiveButtonClass:n,inputErrorClass:o,errorClass:i,...r}){this._form=e,this._inputSelector=t,this._submitButtonSelector=s,this._inactiveButtonClass=n,this._inputErrorClass=o,this._errorClass=i,this._additionalParams=r}enableValidation(){this._formInputs=Array.from(this._form.querySelectorAll(this._inputSelector)),this._formButton=this._form.querySelector(this._submitButtonSelector),this._setEventListeners(),this.toggleButtonState()}toggleButtonState(){this._hasInvalidInput()?this.disableButton():this._enableButton()}_setEventListeners(){this.disableButton(),this._formInputs.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this.toggleButtonState()}))}))}_checkInputValidity(e){const t=this._form.querySelector(`#${e.id}-error`);e.checkValidity()?(t.textContent="",t.classList.remove(this._errorClass)):(t.textContent=e.validationMessage,t.classList.add(this._errorClass))}disableButton(){this._formButton.classList.add(this._inactiveButtonClass),this._formButton.setAttribute("disabled","")}_enableButton(){this._formButton.classList.remove(this._inactiveButtonClass),this._formButton.removeAttribute("disabled","")}_hasInvalidInput(){return this._formInputs.some((e=>!e.validity.valid))}},t={inputSelector:".popup__input",submitButtonSelector:".popup__save-button",inactiveButtonClass:"popup__save-button_invalid",inputErrorClass:"popup__input_type_error",errorClass:"popup__error_visible"},s=document.querySelector("#popup-form-add"),n=document.querySelector("#popup-form-info"),o=document.querySelector(".profile__add-button");class i{constructor(e){this._popup=document.querySelector(e),this._popupCloseButton=this._popup.querySelector(".popup__close")}_handleClosePopupByEsc=e=>{"Escape"===e.key&&this.close()};_handleClosePopupOnOverlay=e=>{e.target===e.currentTarget&&this.close()};_handleClosePopupButton=()=>{this.close()};setEventListener(){this._popupCloseButton.addEventListener("click",this._handleClosePopupButton),this._popup.addEventListener("click",this._handleClosePopupOnOverlay)}open(){this._popup.classList.add("popup_opened"),document.addEventListener("keydown",this._handleClosePopupByEsc)}close(e){this._popup.classList.remove("popup_opened"),document.removeEventListener("keydown",this._handleClosePopupByEsc)}}class r extends i{constructor(e,t){super(e),this._submit=t,this._form=this._popup.querySelector(".popup__form"),this._input=this._form.querySelectorAll(".popup__input")}_getInputValues(){return this._value={},this._input.forEach((e=>{this._value[e.name]=e.value})),this._value}setInputValues(e){this._input.forEach((t=>{t.value=e[t.name]}))}setEventListeners(){super.setEventListener(),this._form.addEventListener("submit",(e=>{e.preventDefault(),this._submit(this._getInputValues())}))}close(){super.close(),this._form.reset()}}const l=new e(s,t),p=new e(n,t);l.enableValidation(),p.enableValidation();const a=new class extends i{constructor(e){super(e),this._popupImage=this._popup.querySelector(".popup__image"),this._popupImageTitle=this._popup.querySelector(".popup__image-title")}open=e=>{this._popupImage.src=e.link,this._popupImage.alt=e.title,this._popupImageTitle.textContent=e.title,super.open()}}("#popup-image"),u=new class{constructor(e){this._profileName=document.querySelector(e.userNameSelector),this._profileDescription=document.querySelector(e.userDescriptionSelector)}getUserInfo(){return{name:this._profileName.textContent,info:this._profileDescription.textContent}}setUserInfo(e){this._profileName.textContent=e.name,this._profileDescription.textContent=e.info}}({userNameSelector:".profile__title",userDescriptionSelector:".profile__subtitle"}),c=new class{constructor({items:e,renderer:t},s){this._items=e,this._renderer=t,this._container=document.querySelector(s)}addCardArray(){this._items.forEach((e=>{this.addItem(e)}))}addItem(e){this._container.prepend(this._renderer(e))}}({items:[{title:"Архыз",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/arkhyz.jpg"},{title:"Челябинская область",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/chelyabinsk-oblast.jpg"},{title:"Иваново",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/ivanovo.jpg"},{title:"Камчатка",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kamchatka.jpg"},{title:"Холмогорский район",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/kholmogorsky-rayon.jpg"},{title:"Байкал",link:"https://pictures.s3.yandex.net/frontend-developer/cards-compressed/baikal.jpg"}],renderer:e=>new class{constructor(e,t,s){this._cardData=e,this._selectorTemplate=t,this._handleOpenPopup=s}_getNewCardFromTemplate(){return document.querySelector(this._selectorTemplate).content.querySelector(".element").cloneNode(!0)}_handleButtonLike=()=>{this._buttonLikeElement.classList.toggle("element__button-like_active")};_handleButtonDeleteElement=()=>{this._cloneElement.remove(),this._cloneElement=null};_setEventListeners(){this._buttonLikeElement.addEventListener("click",this._handleButtonLike),this._buttonDeleteElement.addEventListener("click",this._handleButtonDeleteElement),this._imageElement.addEventListener("click",(()=>this._handleOpenPopup(this._cardData)))}createCard(){return this._cloneElement=this._getNewCardFromTemplate(),this._imageElement=this._cloneElement.querySelector(".element__image"),this._buttonLikeElement=this._cloneElement.querySelector(".element__button-like"),this._buttonDeleteElement=this._cloneElement.querySelector(".element__button-delete"),this._titleElement=this._cloneElement.querySelector(".element__title").textContent=this._cardData.title,this._imageElement.src=this._cardData.link,this._imageElement.alt=this._cardData.title,this._setEventListeners(),this._cloneElement}}(e,".template-cards",a.open).createCard()},".elements");c.addCardArray();const _=new r("#popup-profile",(e=>{u.setUserInfo(e),_.close()})),d=new r("#popup-add",(e=>{c.addItem(e),d.close()}));d.setEventListeners(),a.setEventListener(),_.setEventListeners(),document.querySelector(".profile__edit-button").addEventListener("click",(()=>{_.setInputValues(u.getUserInfo()),_.open(),p.disableButton()})),o.addEventListener("click",(()=>{l.toggleButtonState(),d.open()}))})();